<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Sets the environment variable `key` to the value `value` for the currently running process."><title>set_var in std::env - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="https://doc.rust-lang.org/static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-1a91846b.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="std" data-themes="" data-resource-suffix="1.88.0" data-rustdoc-version="1.88.0 (6b00bc388 2025-06-23)" data-channel="1.88.0" data-search-js="search-f7877310.js" data-settings-js="settings-5514c975.js" ><script src="../../static.files/storage-4e99c027.js"></script><script defer src="sidebar-items1.88.0.js"></script><script defer src="../../static.files/main-7ef8a74a.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-893ab5e7.css"></noscript><link rel="alternate icon" type="image/png" href="https://doc.rust-lang.org/static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-044be391.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button><a class="logo-container" href="../index.html"><img class="rust-logo" src="../../static.files/rust-logo-9a9549ea.svg" alt=""></a></nav><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../index.html"><img class="rust-logo" src="../../static.files/rust-logo-9a9549ea.svg" alt="logo"></a><h2><a href="../index.html">std</a><span class="version">1.88.0</span></h2></div><div class="version">(6b00bc388	2025-06-23)</div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="fn.set_var.html#">set_var</a></h2><h3><a href="fn.set_var.html#">Sections</a></h3><ul class="block top-toc"><li><a href="fn.set_var.html#safety" title="Safety">Safety</a></li><li><a href="fn.set_var.html#panics" title="Panics">Panics</a></li><li><a href="fn.set_var.html#examples" title="Examples">Examples</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="index.html">In std::<wbr>env</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../index.html">std</a>::<wbr><a href="index.html">env</a></div><h1>Function <span class="fn">set_var</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><span class="since" title="Stable since Rust version 1.0.0">1.0.0</span> · <a class="src" href="https://doc.rust-lang.org/src/std/env.rs.html#366-371">Source</a> </span></div><pre class="rust item-decl"><code>pub unsafe fn set_var&lt;K: <a class="trait" href="../convert/trait.AsRef.html" title="trait std::convert::AsRef">AsRef</a>&lt;<a class="struct" href="../ffi/struct.OsStr.html" title="struct std::ffi::OsStr">OsStr</a>&gt;, V: <a class="trait" href="../convert/trait.AsRef.html" title="trait std::convert::AsRef">AsRef</a>&lt;<a class="struct" href="../ffi/struct.OsStr.html" title="struct std::ffi::OsStr">OsStr</a>&gt;&gt;(key: K, value: V)</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Sets the environment variable <code>key</code> to the value <code>value</code> for the currently running
process.</p>
<h2 id="safety"><a class="doc-anchor" href="fn.set_var.html#safety">§</a>Safety</h2>
<p>This function is safe to call in a single-threaded program.</p>
<p>This function is also always safe to call on Windows, in single-threaded
and multi-threaded programs.</p>
<p>In multi-threaded programs on other operating systems, the only safe option is
to not use <code>set_var</code> or <code>remove_var</code> at all.</p>
<p>The exact requirement is: you
must ensure that there are no other threads concurrently writing or
<em>reading</em>(!) the environment through functions or global variables other
than the ones in this module. The problem is that these operating systems
do not provide a thread-safe way to read the environment, and most C
libraries, including libc itself, do not advertise which functions read
from the environment. Even functions from the Rust standard library may
read the environment without going through this module, e.g. for DNS
lookups from <a href="../net/trait.ToSocketAddrs.html" title="trait std::net::ToSocketAddrs"><code>std::net::ToSocketAddrs</code></a>. No stable guarantee is made about
which functions may read from the environment in future versions of a
library. All this makes it not practically possible for you to guarantee
that no other thread will read the environment, so the only safe option is
to not use <code>set_var</code> or <code>remove_var</code> in multi-threaded programs at all.</p>
<p>Discussion of this unsafety on Unix may be found in:</p>
<ul>
<li><a href="https://austingroupbugs.net/view.php?id=188">Austin Group Bugzilla (for POSIX)</a></li>
<li><a href="https://sourceware.org/bugzilla/show_bug.cgi?id=15607#c2">GNU C library Bugzilla</a></li>
</ul>
<p>To pass an environment variable to a child process, you can instead use <a href="../process/struct.Command.html#method.env" title="method std::process::Command::env"><code>Command::env</code></a>.</p>
<h2 id="panics"><a class="doc-anchor" href="fn.set_var.html#panics">§</a>Panics</h2>
<p>This function may panic if <code>key</code> is empty, contains an ASCII equals sign <code>'='</code>
or the NUL character <code>'\0'</code>, or when <code>value</code> contains the NUL character.</p>
<h2 id="examples"><a class="doc-anchor" href="fn.set_var.html#examples">§</a>Examples</h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::env;

<span class="kw">let </span>key = <span class="string">"KEY"</span>;
<span class="kw">unsafe </span>{
    env::set_var(key, <span class="string">"VALUE"</span>);
}
<span class="macro">assert_eq!</span>(env::var(key), <span class="prelude-val">Ok</span>(<span class="string">"VALUE"</span>.to_string()));</code></pre><a class="test-arrow" target="_blank" title="Run code" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0A++++use+std::env;%0A++++%0A++++let+key+=+%22KEY%22;%0A++++unsafe+%7B%0A++++++++env::set_var(key,+%22VALUE%22);%0A++++%7D%0A++++assert_eq!(env::var(key),+Ok(%22VALUE%22.to_string()));%0A%7D&amp;edition=2024"></a></div>
</div></details></section></div></main></body></html>